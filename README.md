# World Explorer

World Explorer — веб‑приложение для интерактивных текстовых путешествий по генерируемым мирам. Игрок создаёт персонажей, выбирает или формирует мир с уникальными сеттингом, атмосферой и жанром, а затем взаимодействует с Гейм‑мастером (LLM), исследуя локации, предметы и связи между ними.

## Возможности прототипа

- Трипанельный интерфейс: слева управление мирами и персонажами, в центре чат с ГМ, справа граф локаций на базе React Flow.
- Локальное хранилище (`data/worlds.json`, `data/characters.json`) с централизованной записью состояния миров, локаций, предметов и истории диалогов.
- Управление персонажами и мирами (создание, редактирование, удаление, привязка персонажа к миру, генерация случайных пресетов).
- Сессия общения с ГМ: история ходов, подсказки для игрока, поддержка вступительного описания мира и последовательных действий.
- Двухуровневые описания локаций: `mapDescription` хранит каноничную «сухую» выжимку для карты, а `narration` генерируется на лету с учётом сеттинга и настроек персонажа.
- Инвентарь персонажа: предметы перемещаются между локациями и героем по решениям ГМ, данные сохраняются между сессиями.
- Адаптер LLM с поддержкой Gemini Pro (через `@google/generative-ai`) и fallback‑провайдером Mock для офлайн‑режима.

## Быстрый старт

```bash
pnpm install
pnpm dev
```

Приложение доступно на `http://localhost:3000`. Для проверки стиля и типизации используйте `pnpm lint`
(в некоторых окружениях может потребоваться установить `@babel/helper-validator-identifier` вручную).

### Конфигурация LLM

1. Создайте файл `.env.local` в корне проекта и добавьте ключи:

   ```bash
   GEMINI_API_KEY=ваш_ключ
   LLM_PROVIDER=gemini # или mock для локальной отладки без ключа
   GEMINI_MODEL=gemini-1.5-pro-latest
   ```

2. Перезапустите dev‑сервер. При отсутствии ключа автоматически используется мок‑провайдер, генерирующий правдоподобные ответы и расширяющий граф на основе шаблонов.

### Структура репозитория

- `src/app` — точки входа Next.js (App Router).
- `src/features` — UI‑модули (Dashboard, ChatPanel, граф и т. д.).
- `src/store` — Zustand‑хранилище приложения.
- `src/lib` — игровые доменные сервисы, адаптеры LLM и репозитории работы с JSON.
- `data/` — локальные JSON‑файлы с состоянием миров и персонажей.
- `docs/` — подробная документация (концепция и roadmap).

## Документация

- `docs/project_overview.md` — концепция игры, модель данных, UX‑сценарии.
- `docs/roadmap.md` — дорожная карта с прогрессом по этапам.

## Следующие шаги

Переезд хранения на Supabase, подключение дополнительных LLM (OpenAI, Anthropic), доработка UI и подготовка деплоя на Vercel описаны в `docs/roadmap.md`.
